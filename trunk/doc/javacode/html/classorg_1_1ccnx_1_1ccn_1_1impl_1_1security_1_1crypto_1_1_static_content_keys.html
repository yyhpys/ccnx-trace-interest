<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Content-Centric Networking in Java: org.ccnx.ccn.impl.security.crypto.StaticContentKeys Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><b>org</b>.<b>ccnx</b>.<b>ccn</b>.<a class="el" href="namespaceorg_1_1ccnx_1_1ccn_1_1impl.html">impl</a>.<b>security</b>.<b>crypto</b>.<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html">StaticContentKeys</a>
  </div>
</div>
<div class="contents">
<h1>org.ccnx.ccn.impl.security.crypto.StaticContentKeys Class Reference</h1><!-- doxytag: class="org::ccnx::ccn::impl::security::crypto::StaticContentKeys" --><!-- doxytag: inherits="org::ccnx::ccn::impl::security::crypto::ContentKeys,Cloneable" -->This is a very simple approach to encryption keying that uses a fixed, static encryption key and an IV "seed" that is used to prefix segment-specific IVs or counters.  
<a href="#_details">More...</a>
<p>
<div class="dynheader">
Inheritance diagram for org.ccnx.ccn.impl.security.crypto.StaticContentKeys:</div>
<div class="dynsection">

<p><center><img src="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.png" usemap="#org.ccnx.ccn.impl.security.crypto.StaticContentKeys_map" border="0" alt=""></center>
<map name="org.ccnx.ccn.impl.security.crypto.StaticContentKeys_map">
<area href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html" alt="org.ccnx.ccn.impl.security.crypto.ContentKeys" shape="rect" coords="0,56,378,80">
<area href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_encrypted_i_v_static_content_keys.html" alt="org.ccnx.ccn.impl.security.crypto.EncryptedIVStaticContentKeys" shape="rect" coords="194,168,572,192">
<area href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_k_d_f_content_keys.html" alt="org.ccnx.ccn.impl.security.crypto.KDFContentKeys" shape="rect" coords="194,224,572,248">
</map>
</div>

<p>
<a href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#3bb81a274104bb97f48f211f4946d43e">StaticContentKeys</a> (String encryptionAlgorithm, byte[] key, byte[] ivCtr)  throws NoSuchAlgorithmException, NoSuchPaddingException </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption...">StaticContentKeys</a> constructor.  <a href="#3bb81a274104bb97f48f211f4946d43e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#d34202e4778e13d830b2dbf1d3974ef7">StaticContentKeys</a> (byte[] key, byte[] ivCtr)  throws NoSuchAlgorithmException, NoSuchPaddingException </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption...">StaticContentKeys</a> with the default algorithm.  <a href="#d34202e4778e13d830b2dbf1d3974ef7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="34207e7e30a2e14040a5024c4bb0be2a"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::StaticContentKeys" ref="34207e7e30a2e14040a5024c4bb0be2a" args="(String encryptionAlgorithm, Key key, byte[] ivCtr)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#34207e7e30a2e14040a5024c4bb0be2a">StaticContentKeys</a> (String encryptionAlgorithm, Key key, byte[] ivCtr)  throws NoSuchAlgorithmException, NoSuchPaddingException </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption...">StaticContentKeys</a> constructor. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="79f4b6a5699a5c76f3e7f9805cc0d846"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::StaticContentKeys" ref="79f4b6a5699a5c76f3e7f9805cc0d846" args="(ContentKeys other)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>StaticContentKeys</b> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html">ContentKeys</a> other)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9345ae44081f7619fdda882f5dea1aed"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::clone" ref="9345ae44081f7619fdda882f5dea1aed" args="()" -->
<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html">ContentKeys</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>clone</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">IvParameterSpec&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#f235bfcae5a046b862e65106c0015cd8">buildIVCtr</a> (KeyAndIV keyAndIV, long segmentNumber, int ctrLen)  throws InvalidKeyException, InvalidAlgorithmParameterException </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Turn a master IV and a segment number into an initial counter of IV for this segment (used in CTR mode).  <a href="#f235bfcae5a046b862e65106c0015cd8"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static synchronized <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html">ContentKeys</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#65eaaff791b23889c11c5de41d3d2f85">generateRandomKeys</a> ()  throws NoSuchAlgorithmException, NoSuchPaddingException </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a set of random encryption/decryption keys using the default algorithm.  <a href="#65eaaff791b23889c11c5de41d3d2f85"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5cbb2437fe1d9d09ed91ef19e490a058"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::segmentSeedValue" ref="5cbb2437fe1d9d09ed91ef19e490a058" args="(byte[] ivCtr, long segmentNumber, int seedLen)" -->
static byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><b>segmentSeedValue</b> (byte[] ivCtr, long segmentNumber, int seedLen)</td></tr>

<tr><td colspan="2"><br><h2>Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="04d3d14bdb6120c06b09afaf808685c4"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::IV_MASTER_LENGTH" ref="04d3d14bdb6120c06b09afaf808685c4" args="" -->
static final int&nbsp;</td><td class="memItemRight" valign="bottom"><b>IV_MASTER_LENGTH</b> = 8</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c8b1e89ed51c823ce5e255bc52b66799"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::SEGMENT_NUMBER_LENGTH" ref="c8b1e89ed51c823ce5e255bc52b66799" args="" -->
static final int&nbsp;</td><td class="memItemRight" valign="bottom"><b>SEGMENT_NUMBER_LENGTH</b> = 6</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a9c82ebce9e6a5b3fdd1cdc95ae3c9d3"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::BLOCK_COUNTER_LENGTH" ref="a9c82ebce9e6a5b3fdd1cdc95ae3c9d3" args="" -->
static final int&nbsp;</td><td class="memItemRight" valign="bottom"><b>BLOCK_COUNTER_LENGTH</b> = INITIAL_BLOCK_COUNTER_VALUE.length</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Cipher&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#0781bfdf168df36e264ba618d44b77da">getSegmentCipher</a> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a> contentName, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_publisher_public_key_digest.html">PublisherPublicKeyDigest</a> publisher, long segmentNumber, boolean encryption)  throws InvalidKeyException, InvalidAlgorithmParameterException, ContentEncodingException </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate a segment encryption or decryption cipher using this stored key material to encrypt or decrypt a particular segment.  <a href="#0781bfdf168df36e264ba618d44b77da"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5037de67ee6aa4fc41251cb32682be9d"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::getKeyAndIVForContent" ref="5037de67ee6aa4fc41251cb32682be9d" args="(ContentName contentName, PublisherPublicKeyDigest publisher, long segmentNumber)" -->
KeyAndIV&nbsp;</td><td class="memItemRight" valign="bottom"><b>getKeyAndIVForContent</b> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a> contentName, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_publisher_public_key_digest.html">PublisherPublicKeyDigest</a> publisher, long segmentNumber)  throws InvalidKeyException, ContentEncodingException </td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This is a very simple approach to encryption keying that uses a fixed, static encryption key and an IV "seed" that is used to prefix segment-specific IVs or counters. 
<p>
The segmenter will be called with parameters identifying:<p>
* the encryption algorithm and mode to use, if any * the encryption key to use for this particular data item (the object to be segmented) * an 8-byte value used as an IV seed for this item (CBC or other block mode) or a random counter component (CTR) (derived in KeyDerivation) * the desired full segment (packet) length, including supporting data<p>
The initial counter or IV for a given block B (number Bnum) in segment Snum will be constructed as follows:<p>
Block IV/CTR = IVseed || Snum || Bnum<p>
where the segment and block numbers is represented in unsigned, 1-based big endian format.<p>
The total width of the IV/Counter value is B, the block width of the cipher. For a stream cipher (e.g. CTR mode), the width B is taken to be 16 bytes.<p>
This IV/CTR is divided into 3 components:<p>
Master IV/IVseed : the master IV seed value, specified by the caller. For this simple static key approach, this is by default 8 bytes. It is given by masterIVLength().<p>
Segment number: this is a binary representation of the segment number. A single-segment object following the SegmentationProfile will still have a segment number component in its name, and will use the specified segment number (usually <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1profiles_1_1_segmentation_profile.html#cd28bc3d6df1a690f90626a5fe656e85" title="Control whether fragments start at 0 or 1.">SegmentationProfile.baseSegment()</a>).<p>
The segment number is encoded in 1-based, unsigned, big-endian form, and represented in the L-N rightmost bytes of the plaintext above, where L is the length of the numeric representation of the segment number, and N is the length of the block number within the segment (for CTR mode, this value is fixed at 1 for CBC and other block modes).<p>
The default width of the segment number is 6 bytes, leaving 8 bytes for the default Master IV width.<p>
Block number: for CTR mode, the last 2 bytes of the IV contain the block (counter) index, starting with 1. For CBC and other block modes, that last two bytes contains the (big endian) value 0x0001.<p>
The same IV expansion function is used regardless of mode for simplicity.<p>
Many of the expansion function calculations are broken out into separate methods to allow for easier subclassing.<p>
IMPORTANT NOTE: Do not use static keying to encrypt network objects in CTR mode, unless you are careful to only save them once per key. Use CBC mode (under development) or a dynamic keying method, such as <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_k_d_f_content_keys.html" title="A subclass of EncryptedIVStaticContentKeys that uses the methods from that class...">KDFContentKeys</a>. <hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="3bb81a274104bb97f48f211f4946d43e"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::StaticContentKeys" ref="3bb81a274104bb97f48f211f4946d43e" args="(String encryptionAlgorithm, byte[] key, byte[] ivCtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">org.ccnx.ccn.impl.security.crypto.StaticContentKeys.StaticContentKeys           </td>
          <td>(</td>
          <td class="paramtype">String&nbsp;</td>
          <td class="paramname"> <em>encryptionAlgorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>ivCtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws NoSuchAlgorithmException, NoSuchPaddingException </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption...">StaticContentKeys</a> constructor. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>encryptionAlgorithm</em>&nbsp;</td><td>(e.g. AES/CTR/NoPadding) the encryption algorithm to use. First component of algorithm should be the algorithm associated with the key. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>key material to be used </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ivctr</em>&nbsp;</td><td>iv or counter material to be used with specified algorithm </td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>NoSuchPaddingException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NoSuchAlgorithmException</em>&nbsp;</td><td></td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="d34202e4778e13d830b2dbf1d3974ef7"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::StaticContentKeys" ref="d34202e4778e13d830b2dbf1d3974ef7" args="(byte[] key, byte[] ivCtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">org.ccnx.ccn.impl.security.crypto.StaticContentKeys.StaticContentKeys           </td>
          <td>(</td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>ivCtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws NoSuchAlgorithmException, NoSuchPaddingException </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption...">StaticContentKeys</a> with the default algorithm. 
<p>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>NoSuchPaddingException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NoSuchAlgorithmException</em>&nbsp;</td><td></td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="65eaaff791b23889c11c5de41d3d2f85"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::generateRandomKeys" ref="65eaaff791b23889c11c5de41d3d2f85" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static synchronized <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html">ContentKeys</a> org.ccnx.ccn.impl.security.crypto.StaticContentKeys.generateRandomKeys           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>  throws NoSuchAlgorithmException, NoSuchPaddingException <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a set of random encryption/decryption keys using the default algorithm. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>a randomly-generated set of keys and IV that can be used for encryption </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>NoSuchPaddingException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NoSuchAlgorithmException</em>&nbsp;</td><td></td></tr>
  </table>
</dl>

<p>Reimplemented in <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_encrypted_i_v_static_content_keys.html#346c08b5a00d6ae591a5640870760e52">org.ccnx.ccn.impl.security.crypto.EncryptedIVStaticContentKeys</a>.</p>

</div>
</div><p>
<a class="anchor" name="0781bfdf168df36e264ba618d44b77da"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::getSegmentCipher" ref="0781bfdf168df36e264ba618d44b77da" args="(ContentName contentName, PublisherPublicKeyDigest publisher, long segmentNumber, boolean encryption)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Cipher org.ccnx.ccn.impl.security.crypto.StaticContentKeys.getSegmentCipher           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a>&nbsp;</td>
          <td class="paramname"> <em>contentName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_publisher_public_key_digest.html">PublisherPublicKeyDigest</a>&nbsp;</td>
          <td class="paramname"> <em>publisher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>segmentNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&nbsp;</td>
          <td class="paramname"> <em>encryption</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws InvalidKeyException, InvalidAlgorithmParameterException, ContentEncodingException <code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate a segment encryption or decryption cipher using this stored key material to encrypt or decrypt a particular segment. 
<p>
This will use the CCN defaults for IV handling, to ensure that segments of a given larger piece of content do not have overlapping key streams. Higher-level functionality embodied in the library (or application-specific code) should be used to make sure that the key, _masterIV pair used for a given multi-block piece of content is unique for that content.<p>
CCN encryption algorithms assume deterministic IV generation (e.g. from cryptographic MAC or ciphers themselves), and therefore do not transport the IV explicitly. Applications that wish to do so need to arrange IV transport.<p>
We assume this stream starts on the first block of a multi-block segement, so for CTR mode, the initial block counter is 1 (block == encryption block). (Conventions for counter start them at 1, not 0.) The cipher will automatically increment the counter; if it overflows the two bytes we've given to it it will start to increment into the segment number. This runs the risk of potentially using up some of the IV space of other segments.<p>
CTR_init = IV_master || segment_number || block_counter CBC_iv = E_Ko(IV_master || segment_number || 0x0001) (just to make it easier, use the same feed value)<p>
CTR value is 16 bytes. 8 bytes are the IV. 6 bytes are the segment number. last 2 bytes are the block number (for 16 byte blocks); if you have more space, use it for the block counter. IV value is the block width of the cipher.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>segmentNumber</em>&nbsp;</td><td>segment to encrypt/decrypt </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>encryption</em>&nbsp;</td><td>true for encryption, false for decryption </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the Cipher </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>InvalidAlgorithmParameterException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ContentEncodingException</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd>getSegmentEncryptionCipher(long) </dd></dl>

<p>Implements <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html#a0859498d408cd3f2a782db5c4aaf2db">org.ccnx.ccn.impl.security.crypto.ContentKeys</a>.</p>

</div>
</div><p>
<a class="anchor" name="f235bfcae5a046b862e65106c0015cd8"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::buildIVCtr" ref="f235bfcae5a046b862e65106c0015cd8" args="(KeyAndIV keyAndIV, long segmentNumber, int ctrLen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IvParameterSpec org.ccnx.ccn.impl.security.crypto.StaticContentKeys.buildIVCtr           </td>
          <td>(</td>
          <td class="paramtype">KeyAndIV&nbsp;</td>
          <td class="paramname"> <em>keyAndIV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>segmentNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ctrLen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws InvalidKeyException, InvalidAlgorithmParameterException </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Turn a master IV and a segment number into an initial counter of IV for this segment (used in CTR mode). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>masterIV</em>&nbsp;</td><td>the master IV </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>segmentNumber</em>&nbsp;</td><td>the segment number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ctrLen</em>&nbsp;</td><td>the output IV length requested </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the initial counter </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InvalidAlgorithmParameterException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td></td></tr>
  </table>
</dl>

<p>Reimplemented in <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_encrypted_i_v_static_content_keys.html#4398a1b1bff6e960d421f6bf718424ba">org.ccnx.ccn.impl.security.crypto.EncryptedIVStaticContentKeys</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>src/org/ccnx/ccn/impl/security/crypto/StaticContentKeys.java</ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Sep 14 12:44:27 2011 for Content-Centric Networking in Java by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
